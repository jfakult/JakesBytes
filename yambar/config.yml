icon: &icon
  font: "HackNerdFont:pixelsize=28"

text_color: &text_color FFD7CFFF
text_color_dim: &text_color_dim FFC7aFAA
text_color_error: &text_color_error FF5522FF

# friendly light pink
mic_color: &mic_color FFB6C1FF

# warm orange
cpu_color: &cpu_color ED724EFF

# friendly bright purple
ssid_color: &ssid_color AC94F4FF

# friendly light green
bitrate_color: &bitrate_color 82C682FF

# fonts we'll be re-using here and there
hackfont: &hackfont HackNerdFont:style=solid:pixelsize=28

std_underline: &std_underline {underline: { size: 2, color: FFFFCCFF}}

bar:
  location: bottom
  height: 48
  font: hack:size=28
  foreground: FFFFCCFF
  background: 113333FF
  spacing: 20

  left:
    - i3:
        anchors: # Not used (directly) by f00bar; used here to avoid duplication
          - string: &i3_common {margin: 8, on-click: "swaymsg --quiet workspace {name}"}
          - string: &default {<<: *i3_common, text: "{name}"}
          - focused: &focused
              deco: {stack: [background: {color: ffa0a04c}, <<: *std_underline]}
              text: "{name}"
          - invisible: &invisible {foreground: ffffff55}
          - urgent: &urgent
              foreground: 000000ff
              deco: {stack: [background: {color: bc2b3fff}, <<: *std_underline]}
          - map: &i3_mode
              default:
                - string:
                    margin: 5
                    text: "{mode}"
                    deco: {background: {color: cc421dff}}
                - empty: {right-margin: 7}
              conditions:
                mode == default: {empty: {}}
        content:
          "":
            map:
              conditions:
                state == focused:   {string: {<<: [*focused, *default]}}
                state == unfocused: {string: {<<: *default}}
                state == invisible: {string: {<<: [*invisible, *default]}}
                state == urgent:    {string: {<<: [*urgent, *default]}}


  right:
    - pipewire:
        foreground: *text_color
        anchors:
          volume: &volume
            conditions:
              type == "sink" && ~muted:
                - string: {text: "\uF130 ", <<: *icon, foreground: *mic_color}
                - string: {text: "{cubic_volume}%"}
              type == "sink" && muted:
                - string: {text: "\uF131 ", <<: *icon}
                - string: {text: "{cubic_volume}%", foreground: *text_color_dim}
        content:
          map:
            <<: *volume
    
    - cpu:
          poll-interval: 4000
          content:
            map:
              conditions:
                id < 0:
                  - string: {text: "\uf4bc", font: *hackfont, foreground: *cpu_color}
                  - string: {text: " {cpu}%", foreground: *text_color}

    - mem:
        poll-interval: 4000
        content:
          - string: {text: "\uEE02", foreground: *cpu_color}
          - string: {text: " {used:mb}MB", foreground: *text_color}
                
    - removables:
        content:
          map:
            conditions:
              mounted:
                string:
                  on-click: sh -c 'notify-send "{device}" "`udisksctl mount -b {device}`"'
                  text: "\uF0C7 {label}"
                  foreground: *text_color
              ~mounted:
                string:
                  on-click: sh -c 'notify-send "{device}" "`udisksctl unmount -b {device}`"'
                  text: "\uF62B {label}"
                  foreground: *text_color_dim
                  # deco: {underline: {size: 1, color: BFFF00FF}}
                  
    - network:
        name: wlan0
        poll-interval: 5000
        content:
          - map:
              conditions:
                state == down:
                  - string: {text: "\uF4AD", <<: *icon, foreground: *ssid_color}
                  - string: {text: " offline", foreground: *text_color_dim}
                state == up:
                  - ramp:
                      tag: signal
                      min: -90
                      max: -30
                      items:
                        # - string: {text: "\U000F0928", foreground: "5FD7FFFF"}
                        # - string: {text: "\U000F0925", foreground: "5FD7FFFF"}
                        # - string: {text: "\U000F0922", foreground: "5FD7FFFF"}
                        # - string: {text: "\U000F091F", foreground: "5FD7FFFF"}
                        # - string: {text: "\U000F092F", foreground: "5FD7FFFF"}
                        - string: {text: "\U000F08FE", foreground: *ssid_color, <<: *icon}
                        - string: {text: "\U000F08F4", foreground: *ssid_color, <<: *icon}
                        - string: {text: "\U000F08F6", foreground: *ssid_color, <<: *icon}
                        - string: {text: "\U000F08F8", foreground: *ssid_color, <<: *icon}
                        - string: {text: "\U000F08FA", foreground: *ssid_color, <<: *icon}
                  - string: {text: " {ssid}", foreground: *text_color}
                default:
                  - string: {text: "\uF254", <<: *icon, foreground: *ssid_color}
                  - string: {text: " {ssid}", foreground: *text_color}

    # Show ipv4 address (or ipv6 if no ipv4)
    - network:
        name: wlan0
        poll-interval: 30000
        content:
          - map:
              conditions:
                state == up:
                  - string: {text: "({ipv4})", foreground: *text_color}
                default:
                  - string: {text: "({ipv6})", foreground: *text_color}

    # Show upload and download speed
    - network:
        name: wlan0
        poll-interval: 4000
        content:
          - map:
              conditions:
                state == up:
                  - string: {text: " \uF093", foreground: *bitrate_color}
                  - string: {text: " {dl-speed:mb}", foreground: *text_color}
                  - string: {text: " \uF019", foreground: *bitrate_color}
                  - string: {text: " {ul-speed:mb}", foreground: *text_color}
                default:
                  - string: {text: " \uF093", foreground: *bitrate_color}
                  - string: {text: " 0", foreground: *text_color}
                  - string: {text: " \uF019", foreground: *bitrate_color}
                  - string: {text: " 0", foreground: *text_color}

    - clock:
        foreground: FFD787FF
        time-format: "%a %b %d, %H:%M"
        content:
          - string: {text: "{time}", foreground: *text_color}
          
    - battery:
        name: BAT1
        poll-interval: 10000
        anchors:
          discharging: &discharging
            list:
              items:
                - ramp:
                    tag: capacity
                    min: 0
                    max: 90
                    items:
                      - string: {text: ' ', foreground: ff0000ff, <<: *icon}
                      - string: {text: ' ', foreground: ffa600ff, <<: *icon}
                      - string: {text: ' ', <<: *icon}
                      - string: {text: ' ', <<: *icon}
                      - string: {text: ' ', <<: *icon}
                      - string: {text: ' ', <<: *icon}
                      - string: {text: ' ', <<: *icon}
                      - string: {text: ' ', foreground: bfff00ff, <<: *icon}
                      - string: {text: ' ', foreground: bfff00ff, <<: *icon}
                - string: {text: "{capacity}%", foreground: *text_color}
        content:
          map:
            conditions:
              state == unknown:
                <<: *discharging
              state == discharging:
                <<: *discharging
              state == charging: &charging
                - string: {text: '', foreground: bfff00ff, <<: *icon}
                - string: {text: "{capacity}%"}
              state == full:
                - string: {text: '', foreground: bfff00ff, <<: *icon}
                - string: {text: "{capacity}%"}
              state == "not charging": *charging