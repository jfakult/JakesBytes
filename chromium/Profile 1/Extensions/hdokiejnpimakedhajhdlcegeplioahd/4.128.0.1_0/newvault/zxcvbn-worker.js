try{function addToDictionary(e,a){Object.keys(a).forEach(function(x){e[x]?e[x].concat(a[x]):e[x]=a[x]})}function setupZXCVBN(x){var e={},e=(addToDictionary(e,zxcvbnts["language-common"].dictionary),addToDictionary(e,zxcvbnts["language-en"].dictionary),addToDictionary(e,zxcvbnts["language-de"].dictionary),addToDictionary(e,zxcvbnts["language-es-es"].dictionary),addToDictionary(e,zxcvbnts["language-fr"].dictionary),addToDictionary(e,zxcvbnts["language-it"].dictionary),addToDictionary(e,zxcvbnts["language-nl-be"].dictionary),addToDictionary(e,zxcvbnts["language-pt-br"].dictionary),{useLevenshteinDistance:x,translations:zxcvbnts["language-en"].translations,graphs:zxcvbnts["language-common"].adjacencyGraphs,dictionary:e});zxcvbnts.core.zxcvbnOptions.setOptions(e),useLevenshteinDistance=x}function challengegetstrength(x,e){var a=25;return calculatePasswordStrength(e,x)*a}function calculatePasswordStrength(x,e){var a,x,a,s;if("undefined"!=typeof zxcvbnts)return a=/\s/g,x=x?x.substring(0,50).replace(a,""):"",a=e?e.substring(0,50).toLowerCase():"",zxcvbnts.core.zxcvbn(x,[a,"lastpass","lastpass.com"]).score;console.error("No zxcvbn functionality available")}function calculateStrengthLegacy(x,e){var x,e,a;if("undefined"!=typeof zxcvbn)return x=x?x.substring(0,50):"",e=e?e.substring(0,50).toLowerCase():"",zxcvbn(x,[e,"lastpass","lastpass.com"]).score;console.error("No zxcvbn functionality available"),sendPostMessage()}function challengecomputescore_async(k,e,C,a,s,t,n,o,F,R,V,r,X,i,d,c,Z,l,g,v,u,h,p,m,f,_,b,y,S,B,w,j,z,D,H,T,W,I,J,K,q){function G(){postMessage({cmd:"report",runtimesec:void 0!==gx?gx:void 0,calcTimeMs:void 0!==startTime?(new Date).getTime()-startTime:void 0,g_totalscore:void 0!==e?e:void 0,g_aSites:void 0!==a?a:void 0,g_numsites:void 0!==s?s:0,g_numblanksites:void 0!==t?t:0,g_avgpasswordlength:void 0!==n?n:0,g_avgstrength:"undefined"!=typeof g_avgstrength?g_avgstrength:0,g_aPasswords:void 0!==o?o:{},g_MAXNUMCOMPUTESCORE:void 0!==F?F:0,g_numduppasswords:void 0!==R?R:0,g_numdupsites:void 0!==V?V:0,g_usernames:void 0!==r?r:[],WEAKPASSWORDSCORE:void 0!==X?X:50,g_strengthscore:void 0!==i?i:0,g_countscore:void 0!==d?d:0,g_numweak:void 0!==c?c:0,sharedavgstrength:void 0!==Z?Z:[],SharedAccounts:void 0!==l?l:[],g_runtimems:void 0!==g?g:0,sfcounts:void 0!==v?v:[],sharedstrengthscore:void 0!==u?u:[],sharedblanksites:void 0!==h?h:[],sharedweak:void 0!==p?p:[],sharedavgpasswordlength:void 0!==m?m:[],SharedPasswords:void 0!==f?f:[],sharedcountscore:void 0!==_?_:[],NonSharedAccounts:void 0!==b?b:[],g_SFNames:void 0!==y?y:[],AllSFNames:void 0!==S?S:[],sharedtotalscore:void 0!==B?B:[],g_numvulnerablesites:void 0!==w?w:0,g_allPasswords:void 0!==j?j:{},g_reuse:void 0!==z?z:void 0,g_blanksites:void 0!==D?D:void 0,g_allnumduppasswords:void 0!==H?H:0})}if(0!==e)G(),console.log("Not processing security score");else{var E,Q=0,x,Y,N,$,xx,ex,U;for(T=void 0===T?{}:T,void 0!==a[E=void 0===k?0:k]&&void 0!==a[E].sfname&&(x=a[E].sfname),void 0===u&&(u=[]),void 0===h&&(h=[]),void 0===p&&(p=[]),void 0===m&&(m=[]),void 0===f&&(f=[]),void 0===_&&(_=[]),void 0===b&&(b=[]),void 0===y&&(y=[]),void 0===S&&(S=[]),void 0===(v=void 0===v?[]:v)[x=void 0===x?"nonshared":x]&&(v[x]=0),v[x]++,void 0===k&&(g_challengeregexcache=[]);E<s;++E){var x,O=("function"==typeof reportprogress&&reportprogress(E,s),x="nonshared",void 0!==a[E].sfname&&(x=a[E].sfname),a[E].usernamedec),P,P=(P=a[E].passworddec)||"",L=a[E].passworddecfix,M=a[E].domain2lvl,ax=void 0!==a[E].realdomain2lvl?a[E].realdomain2lvl:M,sx=void 0!==a[E].vulnerable,ax=(void 0===t&&(t=0),void 0===w&&(w=0),void 0===h[x]&&(h[x]=0),void 0===u[x]&&(u[x]=0),"function"==typeof get_sitepwlen?get_sitepwlen(ax):1),tx=I&&-1!==Object.values(I).indexOf(a[E].id),sx;if(sx?(console.log("challengecomputescore_async : Found vulnerable site domain2lvl="+M+" sfname="+x),"nonshared"==x&&++w,a[E].challenge_score=0):0<P.length&&P.length<ax?a[E].challenge_score=0:(a[E].challenge_score=challengegetstrength(O,P),sx=J&&-1!==Object.values(J).indexOf(a[E].realdomain2lvl),W&&(sx||tx)&&(a[E].is_excluded=!0)),""==L){"nonshared"==x&&t++,h[x]++,void 0!==D&&D.push(E)}else{if("nonshared"==x&&(n+=P.length),void 0===m[x]&&(m[x]=0),m[x]+=P.length,void 0===f[x]&&(f[x]=[]),"nonshared"==x&&!tx){void 0===o[L]&&(o[L]=[]),(void 0===o[L][M]||"function"==typeof o[L][M]&&void 0===o[L][M].push)&&(o[L][M]=[]);try{o[L][M].push(E)}catch(x){return void(L=P=O="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if(void 0===j&&(j=[]),!tx){void 0===j[L]&&(j[L]=[],T[L]=[]),(void 0===j[L][M]||"function"==typeof j[L][M]&&void 0===j[L][M].push)&&(j[L][M]=[],T[L][M]={users:[],hasDifferentUser:!1});try{j[L][M].push(E),T[L][M].hasDifferentUser||T[L][M].users.forEach(function(x){x!==O&&(T[L][M].hasDifferentUser=!0)}),T[L][M].users.push(O)}catch(x){return void(L=P=O="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if("nonshared"!=x){void 0===f[x][L]&&(f[x][L]=[]),(void 0===f[x][L][M]||"function"==typeof f[x][L][M]&&void 0===f[x][L][M].push)&&(f[x][L][M]=[]);try{f[x][L][M].push(E)}catch(x){return void(L=P=O="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if(++Q>F){var ax=null;try{"function"==typeof setTimeout?ax=setTimeout:"undefined"!=typeof LP&&void 0!==LP.mostRecent&&void 0!==LP.mostRecent().setTimeout&&(ax=LP.mostRecent().setTimeout)}catch(x){}var nx=0;return ax(function(){var x;999<a.length&&(x=Number(((E+1)/a.length*100).toFixed(2)),Math.floor(x)==Math.ceil(x))&&console.log(x+"% score calculation done"),challengecomputescore_async(E+1,e,C,a,s,t,n,o,F,R,V,r,X,i,d,c,Z,l,g,v,u,h,p,m,f,_,b,y,S,B,w,j,z,D,H,T,W,I,J,K,q)},0),void(L=P=O="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}L=P=O="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}for(U in g_challengeregexcache=[],n=s==t?0:Math.round(10*n/(s-t))/10,o)if(ex=0,o.hasOwnProperty(U)){var N,ox=!1,A;for(A in N=o[U])T[U][A].hasDifferentUser&&(ox=!0),N.hasOwnProperty(A)&&ex++;if(1==ex&&!ox||""==U){if(void 0!==z)for(var rx in o[U])for(var ix in o[U][rx])delete z[o[U][rx][ix]];delete o[U]}else{for(var A in++R,xx=0,N)N.hasOwnProperty(A)&&(xx+=o[U][A].length);for(var A in V+=xx,N)if(N.hasOwnProperty(A))for(Y in $=o[U][A])$.hasOwnProperty(Y)&&(E=o[U][A][Y],a[E].challenge_numduplicates=xx,a[E].challenge_duplicatescore=a[E].challenge_score/ex)}}U="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",vx();var U="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",dx=0,cx,cx,lx;for(E=0;E<a.length;++E)void 0!==a[E].sfname&&(x=a[E].sfname),void 0===a[E].sfname&&(x="nonshared"),void 0===p[x]&&(p[x]=0),a[E].challenge_scorefinal=a[E].challenge_score,!a[E].usernamedec||-1===a[E].usernamedec.indexOf("@")||a[E].usernamedec in r||(r[a[E].usernamedec]=[],r[a[E].usernamedec].hash=lp_sha2lib.sha256(a[E].usernamedec),r[a[E].usernamedec].link=a[E].link),void 0!==a[E].challenge_dictionary&&void 0!==a[E].challenge_duplicatescore?(a[E].challenge_scorefinal=.5*a[E].challenge_duplicatescore,"nonshared"==x&&++c,"nonshared"!=x&&++p[x]):void 0!==a[E].challenge_dictionary?(a[E].challenge_scorefinal=.5*a[E].challenge_scorefinal,"nonshared"==x&&++c,"nonshared"!=x&&++p[x]):void 0!==a[E].challenge_duplicatescore?(a[E].challenge_scorefinal=a[E].challenge_duplicatescore,void 0===a[E].sfname&&(i+=K&&ux(a[E].id)?0:a[E].challenge_duplicatescore),void 0!==a[E].sfname&&(u[x]+=a[E].challenge_duplicatescore)):(a[E].challenge_score<X&&""!=a[E].passworddecfix&&("nonshared"==x&&++c,"nonshared"!=x)&&++p[x],"nonshared"==x&&(a[E].is_excluded&&!0===a[E].is_excluded&&""!==a[E].passworddec?dx++:i+=K&&ux(a[E].id)?0:a[E].challenge_score,g_avgstrength=s==t?0:Math.round(10*i/(s-t-dx))/10,0!=b.length)&&(g_avgstrength=b.length==t?0:Math.round(10*i/(b.length-t-dx))/10),"nonshared"!=x&&(u[x]+=a[E].challenge_score,Z[x]=v[x]==h[x]?0:Math.round(10*u[x]/(l[x].length-h[x]))/10),void 0===_[x]&&(_[x]=0),70<=a[E].challenge_score&&void 0===a[E].sfname&&(d+=2),70<=a[E].challenge_score&&void 0!==a[E].sfname&&(_[x]+=2));100<d&&(d=100),100<_[x]&&(_[x]=100),0<(s=void 0!==b&&0!=b.length?b.length:s)-t&&(K?(lx=7,(cx=70)<(e=Math.round(i/(s-t-dx)*7)/10)&&(console.error("Password part of total score is over 70"),e=cx)):(cx=100)<(e=Math.round(10*(i/(s-t-dx)*.8+d/10))/10)&&(e=cx));for(var E=0;E<S.length;E++)x=S[E],void 0===l[x]&&(l[x]=[]),void 0===h[x]&&(h[x]=0),0<l[x].length-h[x]&&(B[x]=Math.round(10*(u[x]/(l[x].length-h[x])*.8+_[x]/10))/10);g=(new Date).getTime()-g;var gx=Math.round(g/1e3);G()}function vx(){var x,e,a,s,s="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";for(s in j=void 0===j?{}:j)if(j.hasOwnProperty(s)){var e,a=0,t=!1,n;for(n in e=j[s])T[s][n].hasDifferentUser&&(t=!0),e.hasOwnProperty(n)&&++a;(1!=a||t)&&""!=s||delete j[s]}}function ux(e){var a=JSON.parse(C),x=a[e]&&"1"===a[e].last_credential_monitoring_state,s=a[e]&&1<Number(a[e].last_credential_monitoring_state),t=q.filter(function(x){return lp_sha2lib.sha256(a[e].unencryptedUsername)===x.usernameHash&&-1<a[e].url.indexOf(x.url)});return x||t.length&&!s}}var baseUrl,startTime,LEVENSHTEIN_DEFAULT,useLevenshteinDistance;"function"==typeof importScripts?("https:"==location.protocol?(importScripts("/js-thirdparty/zxcvbn.js"),importScripts("/js-thirdparty/zxcvbn-ts-core.min.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-common.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-en.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-de.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-es-es.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-fr.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-it.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-nl-be.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-pt-br.js"),importScripts("/js/sjcl/sjcl.js"),importScripts("/js/sha256.js")):(baseUrl=location.pathname.slice(0,-26),importScripts(baseUrl+"/zxcvbn.js"),importScripts(baseUrl+"/zxcvbn-ts.js"),importScripts(baseUrl+"/zxcvbn-ts-language-common.js"),importScripts(baseUrl+"/zxcvbn-ts-language-en.js"),importScripts(baseUrl+"/zxcvbn-ts-language-de.js"),importScripts(baseUrl+"/zxcvbn-ts-language-es-es.js"),importScripts(baseUrl+"/zxcvbn-ts-language-fr.js"),importScripts(baseUrl+"/zxcvbn-ts-language-it.js"),importScripts(baseUrl+"/zxcvbn-ts-language-nl-be.js"),importScripts(baseUrl+"/zxcvbn-ts-language-pt-br.js"),importScripts(baseUrl+"/sjcl.js"),importScripts(baseUrl+"/sha256.js")),onmessage=function(x){var e;"zxcvbn"===x.data.source&&"challengecomputescore_async"===x.data.cmd&&(startTime=(new Date).getTime(),setupZXCVBN(!0),challengecomputescore_async(x.data.curr,x.data.g_totalscore,JSON.parse(x.data.g_sites),x.data.g_aSites&&x.data.g_aSites.length?x.data.g_aSites:[],x.data.g_numsites,x.data.g_numblanksites,x.data.g_avgpasswordlength,x.data.g_aPasswords,x.data.g_MAXNUMCOMPUTESCORE,x.data.g_numduppasswords,x.data.g_numdupsites,x.data.g_usernames,x.data.WEAKPASSWORDSCORE,x.data.g_strengthscore,x.data.g_countscore,x.data.g_numweak,x.data.sharedavgstrength,x.data.SharedAccounts,x.data.g_runtimems,x.data.sfcounts,x.data.sharedstrengthscore,x.data.sharedblanksites,x.data.sharedweak,x.data.sharedavgpasswordlength,x.data.SharedPasswords,x.data.sharedcountscore,x.data.NonSharedAccounts,x.data.g_SFNames,x.data.AllSFNames,x.data.sharedtotalscore,x.data.g_numvulnerablesites,x.data.g_allPasswords,x.data.g_reuse,x.data.g_blanksites,x.data.g_allnumduppasswords,x.data.equivalentDomainCheckList,x.data.isExcludeSwitchedOn,x.data.excludedPasswords,x.data.domainsForAutomaticPasswordExclude,x.data.isFeatureEnabledSecurityDashboard2_0,x.data.dwmAlerts)),"compute_password_strength"===x.data.cmd&&(void 0===x.data.useLevenshteinDistance&&useLevenshteinDistance!==LEVENSHTEIN_DEFAULT?setupZXCVBN(LEVENSHTEIN_DEFAULT):void 0!==x.data.useLevenshteinDistance&&x.data.useLevenshteinDistance!==useLevenshteinDistance&&setupZXCVBN(x.data.useLevenshteinDistance),e=challengegetstrength(x.data.username,x.data.password),postMessage({cmd:"compute_password_strength_result",result:e,password:lp_sha2lib.sha256(x.data.password)}))},setupZXCVBN(useLevenshteinDistance=LEVENSHTEIN_DEFAULT=!1)):console.info("Zxcvbn-Worker initial phase done")}catch(x){console.error("inside-zxcvbn-worker",x)}